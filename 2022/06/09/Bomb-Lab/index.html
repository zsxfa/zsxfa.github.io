<!DOCTYPE html>
<html lang="en">


<head>

  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.1.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/alien.png">
  <meta name="google-site-verification" content="gNcq-rP8_Ahmh-wcxj35y0OipCZz-Q6PviyRJK5pHXw">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"zsxfa.cn","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false,"b2t":false,"scrollpercent":true},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"livere","storage":true,"lazyload":false,"nav":null,"activeClass":"livere"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="二进制炸弹实验最近看了计算机系统基础实验这门课程，做了Bomb Lab的实验，然后做做相应的总结。">
<meta property="og:type" content="article">
<meta property="og:title" content="Bomb Lab">
<meta property="og:url" content="http://zsxfa.cn/2022/06/09/Bomb-Lab/index.html">
<meta property="og:site_name">
<meta property="og:description" content="二进制炸弹实验最近看了计算机系统基础实验这门课程，做了Bomb Lab的实验，然后做做相应的总结。">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/05/10-52-50-20220605105249-132f74.png">
<meta property="og:image" content="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/05/10-59-13-20220605105912-fcaa45.png">
<meta property="og:image" content="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/05/11-49-21-20220605114920-87ced2.png">
<meta property="og:image" content="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/05/15-35-02-20220605153501-024294.png">
<meta property="og:image" content="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/05/15-37-16-20220605153716-78b8b4.png">
<meta property="og:image" content="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/05/15-38-38-20220605153837-26637b.png">
<meta property="og:image" content="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/05/15-39-04-20220605153903-32a9f2.png">
<meta property="og:image" content="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/05/16-07-32-20220605160731-86122e.png">
<meta property="og:image" content="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/05/16-47-55-20220605164755-9db933.png">
<meta property="og:image" content="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/08/22-30-37-20220608223037-cd3847.png">
<meta property="og:image" content="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/05/23-49-50-20220605234949-b99942.png">
<meta property="og:image" content="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/08/22-29-41-20220608222941-3af148.png">
<meta property="og:image" content="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/06/12-27-59-%7DK_%7BW%7BC-7HRI3%606%60KS%609DP9-cf53b5.png">
<meta property="og:image" content="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/08/R5$71RI@[LTY9T]~8Y1_27Q.png">
<meta property="og:image" content="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/08/11-03-18-20220608110317-c08ab5.png">
<meta property="og:image" content="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/08/11-05-56-20220608110556-2d71e2.png">
<meta property="og:image" content="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/09/10-58-16--C6MVT-%7B-%606-BL%60A36IPDUN-444e1c.png">
<meta property="og:image" content="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/09/10-34-25-20220609103424-40c87a.png">
<meta property="og:image" content="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/09/20-11-21-20220609201120-0245ff.png">
<meta property="og:image" content="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/09/16-11-48-20220609161148-a534a5.png">
<meta property="article:published_time" content="2022-06-09T13:03:18.000Z">
<meta property="article:modified_time" content="2022-06-09T13:45:47.278Z">
<meta property="article:author" content="小Feng">
<meta property="article:tag" content="Bomb—Lab 汇编">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/05/10-52-50-20220605105249-132f74.png">

<link rel="canonical" href="http://zsxfa.cn/2022/06/09/Bomb-Lab/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Bomb Lab | </title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-K4J8QJV58T"></script>
    <script data-pjax>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-K4J8QJV58T');
      }
    </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="null" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>
	<a target="_blank" rel="noopener" href="https://github.com/zsxfa/zsxfa.github.io" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title"></h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://zsxfa.cn/2022/06/09/Bomb-Lab/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/01/14/1642171382.png">
      <meta itemprop="name" content="小Feng">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Bomb Lab
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-06-09 21:03:18 / Modified: 21:45:47" itemprop="dateCreated datePublished" datetime="2022-06-09T21:03:18+08:00">2022-06-09</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/interesting/" itemprop="url" rel="index"><span itemprop="name">interesting</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>13k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>12 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="二进制炸弹实验"><a href="#二进制炸弹实验" class="headerlink" title="二进制炸弹实验"></a>二进制炸弹实验</h1><p>最近看了计算机系统基础实验这门课程，做了Bomb Lab的实验，然后做做相应的总结。</p>
<span id="more"></span>

<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>一个二进制炸弹是一个 Linux 可执行程序，包含了多个阶段（又称为层次、关卡）。在炸弹程序运行的每个阶段要求输入一个特定字符串，如果该输入字符串符合程序的要求，该阶段的炸弹就被拆除了，否则炸弹“爆炸——即打印输出“BOOM!!!”的提示。 </p>
<p><strong>每个炸弹阶段考察了程序与数据的机器级表示的不同方面，难度逐级递增：</strong> </p>
<ul>
<li>阶段 0：字符串比较</li>
<li>阶段 1：浮点数表示</li>
<li>阶段 2：循环</li>
<li>阶段 3：条件/分支</li>
<li>阶段 4：递归调用和栈</li>
<li>阶段 5：指针</li>
<li>阶段 6：链表/指针/结构</li>
<li>另外还有一个隐藏阶段作为阶段 7，只有在阶段 4 的拆解字符串后附加一特定字符串后，才能在实验最后进入隐藏阶段。</li>
</ul>
<p>实验的目标是拆除尽可能多的炸弹关卡——分析获得尽可能多的正确拆解字符串。 </p>
<h2 id="实验数据"><a href="#实验数据" class="headerlink" title="实验数据"></a>实验数据</h2><p><a target="_blank" rel="noopener" href="http://cs.nju.edu.cn/sufeng/course/mooc/0809NJU064_bomblab.tar">http://cs.nju.edu.cn/sufeng/course/mooc/0809NJU064_bomblab.tar</a> </p>
<p>可在 Linux 实验环境中使用命令“tar xvf 0809NJU064_bomblab.tar”将其中包含的文件提取到当前目录中。该 tar 文件中包含如下实验所需文件： </p>
<ul>
<li>bomb：二进制炸弹可执行程序</li>
<li>bomb.c：包含 bomb 程序中 main 函数的 C 语言程序框架</li>
</ul>
<h2 id="实验工具"><a href="#实验工具" class="headerlink" title="实验工具"></a>实验工具</h2><p>完成二进制炸弹拆除任务，可使用 objdump 工具程序反汇编可执行炸弹程序，并使用gdb 工具程序单步跟踪每一阶段的机器指令，从中理解每一指令的行为和作用，进而推断拆除炸弹所需的目标字符串的内容组成。例如，可在每一阶段的起始指令前和引爆炸弹的函数调用指令前设置断点。 </p>
<h3 id="GDB"><a href="#GDB" class="headerlink" title="GDB"></a>GDB</h3><p>为从二进制炸弹可执行程序”bomb“中找出触发炸弹爆炸的条件，可使用 GDB 程序帮助对程序的分析。GDB 是 GNU 开源组织发布的一个强大的交互式程序调试工具。一般来说，GDB 可帮助完成以下几方面的调试工作（更详细描述可参看 GDB 文档和相关资料）： </p>
<ul>
<li>装载、启动被调试的程序</li>
<li>使被调试程序在指定的调试断点处中断执行，以方便查看程序变量、寄存器、栈内容等程序运行的现场数据</li>
<li>动态改变程序的执行环境，如修改变量的值</li>
</ul>
<h3 id="objdump"><a href="#objdump" class="headerlink" title="objdump"></a>objdump</h3><p>反汇编二进制炸弹程序，获得其中汇编指令供分析</p>
<ul>
<li><p><code>objdump -d bomb</code>       输出bomb程序的反汇编结果</p>
</li>
<li><p><code>objdump -d bomb &gt; bomb.s</code> 获得bomb程序的反汇编结果并保存于文本文件bomb.s中供分析</p>
<ul>
<li>–d 选项：对二进制程序中的机器指令代码进行反汇编。通过分析汇编源代码可以发现bomb 程序是如何运行的</li>
</ul>
</li>
<li><p><code>objdump -t bomb</code> 打印bomb程序的符号表，其中包含bomb中所有函数、全局变量的名称和存储地址</p>
<ul>
<li>–t 选项：打印指定二进制程序的符号表，其中包含了程序中的函数、全局变量的名称和存储地址</li>
</ul>
</li>
</ul>
<h3 id="strings"><a href="#strings" class="headerlink" title="strings"></a>strings</h3><p>该命令显示二进制程序中的所有可打印字符串 </p>
<h2 id="反汇编代码"><a href="#反汇编代码" class="headerlink" title="反汇编代码"></a>反汇编代码</h2><ol>
<li><p>在命令行执行以下命令，将汇编代码重定向到bomb.s文件中</p>
<p>.s结尾代表汇编代码，未进行预处理</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">objdump -d bomb &gt; bomb.s</span><br></pre></td></tr></table></figure></li>
<li><p>可以使用任何文本查看工具打开bomb.s文件，内容就是反汇编的结果</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">less bomb.s</span><br></pre></td></tr></table></figure></li>
<li><p>在bomb.s中搜索phase_0函数</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/phase_0</span><br></pre></td></tr></table></figure>

<p>使用n(next)和p(pervious)查找上一个和下一个</p>
<p>使用q退出查看模式</p>
</li>
</ol>
<h3 id="反汇编代码的理解"><a href="#反汇编代码的理解" class="headerlink" title="反汇编代码的理解"></a>反汇编代码的理解</h3><p><img src="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/05/10-52-50-20220605105249-132f74.png"></p>
<h3 id="过程栈帧及入口参数的位置"><a href="#过程栈帧及入口参数的位置" class="headerlink" title="过程栈帧及入口参数的位置"></a>过程栈帧及入口参数的位置</h3><p><img src="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/05/10-59-13-20220605105912-fcaa45.png"></p>
<h1 id="阶段-0：字符串比较"><a href="#阶段-0：字符串比较" class="headerlink" title="阶段 0：字符串比较"></a>阶段 0：字符串比较</h1><h2 id="1-对二进制炸弹程序进行反汇编"><a href="#1-对二进制炸弹程序进行反汇编" class="headerlink" title="1.对二进制炸弹程序进行反汇编"></a>1.对二进制炸弹程序进行反汇编</h2><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">objdump -d <span class="keyword">bomb </span>&gt; <span class="keyword">bomb.s</span></span><br></pre></td></tr></table></figure>

<h2 id="2-对函数的汇编指令代码进行分析"><a href="#2-对函数的汇编指令代码进行分析" class="headerlink" title="2.对函数的汇编指令代码进行分析"></a>2.对函数的汇编指令代码进行分析</h2><p><strong>定位到phase_0函数上</strong>，分析<code>test,je,call</code>代码发现</p>
<p>为避免执行<code>0x8049471</code>处对引爆炸弹函数的调用指令，<code>je</code>指令的测试条件应被满足，即<code>0x804946d</code>处<code>test</code>指令执行之前，寄存器EAX的值应为0,同时可以判断出<code>pushl</code>处是用户输入的字符串地址，<code>push</code>处是内部保存的字符串地址，所以需要满足<code>pushl</code>处输入的和<code>push</code>处的字符串相同。</p>
<p><img src="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/05/11-49-21-20220605114920-87ced2.png"></p>
<p><strong>功能说明</strong>：如果输入的两个字符串参数的内容相同，strings_not_equal函数将返回0，则在示例汇编代码中，test指令测试时，将使得je指令跳转到程序的正常结束位置。</p>
<p>否则引爆炸弹</p>
<p><strong>分析strings_not_equal函数的控制逻辑</strong></p>
<p>分析汇编代码可知：该函数在输入的两个字符串参数的长度和内容均相同时将返回0，否则返回1，并且返回值保存于EAX寄存器中</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">08049c61</span> &lt;strings_not_equal&gt;:</span><br><span class="line"> <span class="attribute">8049c61</span>:       <span class="number">55</span>                      push   %ebp</span><br><span class="line"> <span class="attribute">8049c62</span>:       <span class="number">89</span> e5                   mov    %esp,%ebp</span><br><span class="line"> <span class="attribute">8049c64</span>:       <span class="number">53</span>                      push   %ebx</span><br><span class="line"> <span class="attribute">8049c65</span>:       <span class="number">83</span> ec <span class="number">10</span>                sub    $<span class="number">0</span>x10,%esp</span><br><span class="line"> <span class="attribute">8049c68</span>:       ff <span class="number">75</span> <span class="number">08</span>                pushl  <span class="number">0</span>x8(%ebp)</span><br><span class="line"> <span class="attribute">8049c6b</span>:       e8 c5 ff ff ff          call   <span class="number">8049</span>c35 &lt;string_length&gt;</span><br><span class="line"> <span class="attribute">8049c70</span>:       <span class="number">83</span> c4 <span class="number">04</span>                add    $<span class="number">0</span>x4,%esp</span><br><span class="line"> <span class="attribute">8049c73</span>:       <span class="number">89</span> c3                   mov    %eax,%ebx</span><br><span class="line"> <span class="attribute">8049c75</span>:       ff <span class="number">75</span> <span class="number">0</span>c                pushl  <span class="number">0</span>xc(%ebp)</span><br><span class="line"> <span class="attribute">8049c78</span>:       e8 b8 ff ff ff          call   <span class="number">8049</span>c35 &lt;string_length&gt;</span><br><span class="line"> <span class="attribute">8049c7d</span>:       <span class="number">83</span> c4 <span class="number">04</span>                add    $<span class="number">0</span>x4,%esp</span><br><span class="line"> <span class="attribute">8049c80</span>:       <span class="number">39</span> c3                   cmp    %eax,%ebx</span><br><span class="line"> <span class="attribute">8049c82</span>:       <span class="number">74</span> <span class="number">07</span>                   je     <span class="number">8049</span>c8b &lt;strings_not_equal+<span class="number">0</span>x2a&gt;</span><br><span class="line"> <span class="attribute">8049c84</span>:       b8 <span class="number">01</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>          mov    $<span class="number">0</span>x1,%eax</span><br><span class="line"> <span class="attribute">8049c89</span>:       eb <span class="number">3</span>c                   jmp    <span class="number">8049</span>cc7 &lt;strings_not_equal+<span class="number">0</span>x66&gt;</span><br><span class="line"> <span class="attribute">8049c8b</span>:       <span class="number">8</span>b <span class="number">45</span> <span class="number">08</span>                mov    <span class="number">0</span>x8(%ebp),%eax</span><br><span class="line"> <span class="attribute">8049c8e</span>:       <span class="number">89</span> <span class="number">45</span> f8                mov    %eax,-<span class="number">0</span>x8(%ebp)</span><br><span class="line"> <span class="attribute">8049c91</span>:       <span class="number">8</span>b <span class="number">45</span> <span class="number">0</span>c                mov    <span class="number">0</span>xc(%ebp),%eax</span><br><span class="line"> <span class="attribute">8049c94</span>:       <span class="number">89</span> <span class="number">45</span> f4                mov    %eax,-<span class="number">0</span>xc(%ebp)</span><br><span class="line"> <span class="attribute">8049c97</span>:       eb <span class="number">1</span>f                   jmp    <span class="number">8049</span>cb8 &lt;strings_not_equal+<span class="number">0</span>x57&gt;</span><br><span class="line"> <span class="attribute">8049c99</span>:       <span class="number">8</span>b <span class="number">45</span> f8                mov    -<span class="number">0</span>x8(%ebp),%eax</span><br><span class="line"> <span class="attribute">8049c9c</span>:       <span class="number">0</span>f b6 <span class="number">10</span>                movzbl (%eax),%edx</span><br><span class="line"> <span class="attribute">8049c9f</span>:       <span class="number">8</span>b <span class="number">45</span> f4                mov    -<span class="number">0</span>xc(%ebp),%eax</span><br><span class="line"> <span class="attribute">8049ca2</span>:       <span class="number">0</span>f b6 <span class="number">00</span>                movzbl (%eax),%eax</span><br><span class="line"> <span class="attribute">8049ca5</span>:       <span class="number">38</span> c2                   cmp    %al,%dl</span><br><span class="line"> <span class="attribute">8049ca7</span>:       <span class="number">74</span> <span class="number">07</span>                   je     <span class="number">8049</span>cb0 &lt;strings_not_equal+<span class="number">0</span>x4f&gt;</span><br><span class="line"> <span class="attribute">8049ca9</span>:       b8 <span class="number">01</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>          mov    $<span class="number">0</span>x1,%eax</span><br><span class="line"> <span class="attribute">8049cae</span>:       eb <span class="number">17</span>                   jmp    <span class="number">8049</span>cc7 &lt;strings_not_equal+<span class="number">0</span>x66&gt;</span><br><span class="line"> <span class="attribute">8049cb0</span>:       <span class="number">83</span> <span class="number">45</span> f8 <span class="number">01</span>             addl   $<span class="number">0</span>x1,-<span class="number">0</span>x8(%ebp)</span><br><span class="line"> <span class="attribute">8049cb4</span>:       <span class="number">83</span> <span class="number">45</span> f4 <span class="number">01</span>             addl   $<span class="number">0</span>x1,-<span class="number">0</span>xc(%ebp)</span><br><span class="line"> <span class="attribute">8049cb8</span>:       <span class="number">8</span>b <span class="number">45</span> f8                mov    -<span class="number">0</span>x8(%ebp),%eax</span><br><span class="line"> <span class="attribute">8049cbb</span>:       <span class="number">0</span>f b6 <span class="number">00</span>                movzbl (%eax),%eax</span><br><span class="line"> <span class="attribute">8049cbe</span>:       <span class="number">84</span> c0                   test   %al,%al</span><br><span class="line"> <span class="attribute">8049cc0</span>:       <span class="number">75</span> d7                   jne    <span class="number">8049</span>c99 &lt;strings_not_equal+<span class="number">0</span>x38&gt;</span><br><span class="line"> <span class="attribute">8049cc2</span>:       b8 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>          mov    $<span class="number">0</span>x0,%eax</span><br><span class="line"> <span class="attribute">8049cc7</span>:       <span class="number">8</span>b <span class="number">5</span>d fc                mov    -<span class="number">0</span>x4(%ebp),%ebx</span><br><span class="line"> <span class="attribute">8049cca</span>:       c9                      leave</span><br><span class="line"> <span class="attribute">8049ccb</span>:       c3                      ret</span><br></pre></td></tr></table></figure>

<h2 id="3-定位并获得内置字符串的值，并相应构造输入字符串"><a href="#3-定位并获得内置字符串的值，并相应构造输入字符串" class="headerlink" title="3.定位并获得内置字符串的值，并相应构造输入字符串"></a>3.定位并获得内置字符串的值，并相应构造输入字符串</h2><p>前面已推断出：和用户输入字符串相比较的程序内置字符串的存储地址为<code>0x804a1e0</code>，并且两个字符串的内容应相同，因此可使用gdb查看地址<code>0x804a1e0</code>中存储的内置字符串的内容：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">ics@debian:~/test/bomlab$ gdb bomb</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">断点设置到phase_0函数中调用strings_not_equal函数的call指令的位置</span></span><br><span class="line">(gdb) b *0x8049465</span><br><span class="line">Breakpoint 1 at 0x8049465</span><br><span class="line">(gdb) r</span><br><span class="line">Starting program: /home/ics/test/bomlab/bomb</span><br><span class="line">Welcome to my fiendish little bomb. You have 7 phases with</span><br><span class="line">which to blow yourself up. Have a nice day!</span><br><span class="line">fdafada（这里先随意输入一些字符串）</span><br><span class="line"></span><br><span class="line">Breakpoint 1, 0x08049465 in phase_0 ()</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看50个字节的内容，每个字节内容作为字符输出</span></span><br><span class="line">(gdb)x/50c 0x804a1e0</span><br><span class="line">0x804a1e0:	65 &#x27;A&#x27;	32 &#x27; &#x27;	116 &#x27;t&#x27;	101 &#x27;e&#x27;	120 &#x27;x&#x27;	116 &#x27;t&#x27;	32 &#x27; &#x27;	108 &#x27;l&#x27;</span><br><span class="line">0x804a1e8:	105 &#x27;i&#x27;	110 &#x27;n&#x27;	101 &#x27;e&#x27;	32 &#x27; &#x27;	105 &#x27;i&#x27;	115 &#x27;s&#x27;	32 &#x27; &#x27;	97 &#x27;a&#x27;</span><br><span class="line">0x804a1f0:	32 &#x27; &#x27;	115 &#x27;s&#x27;	101 &#x27;e&#x27;	113 &#x27;q&#x27;	117 &#x27;u&#x27;	101 &#x27;e&#x27;	110 &#x27;n&#x27;	99 &#x27;c&#x27;</span><br><span class="line">0x804a1f8:	101 &#x27;e&#x27;	32 &#x27; &#x27;	111 &#x27;o&#x27;	102 &#x27;f&#x27;	32 &#x27; &#x27;	65 &#x27;A&#x27;	83 &#x27;S&#x27;	67 &#x27;C&#x27;</span><br><span class="line">0x804a200:	73 &#x27;I&#x27;	73 &#x27;I&#x27;	32 &#x27; &#x27;	99 &#x27;c&#x27;	104 &#x27;h&#x27;	97 &#x27;a&#x27;	114 &#x27;r&#x27;	97 &#x27;a&#x27;</span><br><span class="line">0x804a208:	99 &#x27;c&#x27;	116 &#x27;t&#x27;	101 &#x27;e&#x27;	114 &#x27;r&#x27;	115 &#x27;s&#x27;	46 &#x27;.&#x27;	0 &#x27;\000&#x27;	37 &#x27;%&#x27;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">直接输出的方式</span></span><br><span class="line">(gdb)x/1s 0x804a1e0</span><br><span class="line">0x804a1e0:	&quot;A text line is a sequence of ASCII characters.&quot;</span><br></pre></td></tr></table></figure>

<h3 id="4-测试"><a href="#4-测试" class="headerlink" title="4.测试"></a>4.测试</h3><p>随意输入的结果</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ics@debian:~/test/bomlab$ ./bomb</span><br><span class="line">Welcome to my fiendish little bomb. You have 7 phases with</span><br><span class="line">which to blow yourself up. Have a nice day!</span><br><span class="line">asdfa</span><br><span class="line"></span><br><span class="line">BOOM!!!</span><br><span class="line">The bomb has blown up.</span><br></pre></td></tr></table></figure>

<p>输入获取到的字符串</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ics@debian:~/test/bomlab$ ./bomb</span><br><span class="line">Welcome to my fiendish little bomb. You have 7 phases with</span><br><span class="line">which to blow yourself up. Have a nice day!</span><br><span class="line">A text line is a sequence of ASCII characters.</span><br><span class="line">Well done! You seem to have warmed up!</span><br></pre></td></tr></table></figure>



<h1 id="阶段-1：浮点数表示"><a href="#阶段-1：浮点数表示" class="headerlink" title="阶段 1：浮点数表示"></a>阶段 1：浮点数表示</h1><p><strong>阶段说明：该阶段要求输入对应某浮点（float或double）数值表示的一对整数（short或int）</strong></p>
<h2 id="IEEE-754标准"><a href="#IEEE-754标准" class="headerlink" title="IEEE 754标准"></a>IEEE 754标准</h2><p><img src="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/05/15-35-02-20220605153501-024294.png"></p>
<h2 id="X87浮点指令-MMX和SSE指令"><a href="#X87浮点指令-MMX和SSE指令" class="headerlink" title="X87浮点指令(MMX和SSE指令)"></a>X87浮点指令(MMX和SSE指令)</h2><p><img src="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/05/15-37-16-20220605153716-78b8b4.png"></p>
<h2 id="X87-FPU指令"><a href="#X87-FPU指令" class="headerlink" title="X87 FPU指令"></a>X87 FPU指令</h2><p><img src="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/05/15-38-38-20220605153837-26637b.png"></p>
<p><img src="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/05/15-39-04-20220605153903-32a9f2.png"></p>
<p>实验步骤：</p>
<h2 id="1-对本阶段函数的汇编指令代码进行分析"><a href="#1-对本阶段函数的汇编指令代码进行分析" class="headerlink" title="1.对本阶段函数的汇编指令代码进行分析"></a>1.对本阶段函数的汇编指令代码进行分析</h2><p>定位到<code>phase_1</code>函数上</p>
<p><img src="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/05/16-07-32-20220605160731-86122e.png"></p>
<h2 id="2-找到浮点数常量的值，获得其IEEE-754表示"><a href="#2-找到浮点数常量的值，获得其IEEE-754表示" class="headerlink" title="2.找到浮点数常量的值，获得其IEEE-754表示"></a>2.找到浮点数常量的值，获得其IEEE-754表示</h2><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">08049484</span> &lt;phase_<span class="number">1</span>&gt;:</span><br><span class="line"> <span class="number">8049484</span>:       <span class="number">55</span>                      push   <span class="variable">%ebp</span></span><br><span class="line"> <span class="number">8049485</span>:       <span class="number">89</span> e<span class="number">5</span>                   mov    <span class="variable">%esp</span><span class="punctuation">,</span><span class="variable">%ebp</span></span><br><span class="line"> <span class="number">8049487</span>:       <span class="number">83</span> ec <span class="number">28</span>                <span class="keyword">sub</span>    $<span class="number">0x28</span><span class="punctuation">,</span><span class="variable">%esp</span></span><br><span class="line"> <span class="number">804948</span>a:       <span class="keyword">c</span><span class="number">7</span> <span class="number">45</span> f<span class="number">4</span> a<span class="number">1</span> <span class="number">84</span> <span class="number">76</span> <span class="number">09</span>    movl   $<span class="number">0x97684a1</span><span class="punctuation">,</span><span class="number">-0</span>xc(<span class="variable">%ebp</span>)</span><br><span class="line"> <span class="number">8049491</span>:       db <span class="number">45</span> f<span class="number">4</span>                fildl  <span class="number">-0</span>xc(<span class="variable">%ebp</span>)</span><br><span class="line"> <span class="number">8049494</span>:       dd <span class="number">5</span>d e<span class="number">8</span>                fstpl  <span class="number">-0</span><span class="keyword">x</span><span class="number">18</span>(<span class="variable">%ebp</span>)</span><br><span class="line"> ...</span><br></pre></td></tr></table></figure>

<ul>
<li>从中可看出，整型值<code>0x97684a1</code>通过浮点栈被转为<strong>双精度</strong>浮点表示，并传送到本阶段函数栈帧中地址为**-0x18(%ebp)**处开始连续存放</li>
<li>从课程内容可知，该常量值的双精度（double）IEEE 754表示为（十六进制字节串）：41 A2 ED 09 42 0 0 0  </li>
</ul>
<h2 id="3-分析程序的输入要求和比较逻辑"><a href="#3-分析程序的输入要求和比较逻辑" class="headerlink" title="3.分析程序的输入要求和比较逻辑"></a>3.分析程序的输入要求和比较逻辑</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">8049497</span>:       <span class="number">8</span>d <span class="number">45</span> e0                lea    -<span class="number">0</span>x20(%ebp),%eax</span><br><span class="line"> <span class="attribute">804949a</span>:       <span class="number">50</span>                      push   %eax</span><br><span class="line"> <span class="attribute">804949b</span>:       <span class="number">8</span>d <span class="number">45</span> e4                lea    -<span class="number">0</span>x1c(%ebp),%eax</span><br><span class="line"> <span class="attribute">804949e</span>:       <span class="number">50</span>                      push   %eax</span><br><span class="line"> <span class="attribute">804949f</span>:       <span class="number">68</span> <span class="number">0</span>f a2 <span class="number">04</span> <span class="number">08</span>          push   $<span class="number">0</span>x804a20f</span><br><span class="line"> <span class="attribute">80494a4</span>:       ff <span class="number">75</span> <span class="number">08</span>                pushl  <span class="number">0</span>x8(%ebp)</span><br><span class="line"> <span class="attribute">80494a7</span>:       e8 <span class="number">24</span> fc ff ff          call   <span class="number">80490</span>d0 &lt;__isoc99_sscanf@plt&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>输入拆解字符串的解析调用了sscanf函数，</p>
<p>其原型如下：</p>
<ul>
<li>int sscanf ( const char * s, const char * format, …);</li>
<li>返回从第一个输入字符串中成功扫描，读入的数据项的个数</li>
</ul>
</li>
<li><p>输入格式字符串起始地址位于<code>0x804a20f</code>，可使用gdb查看存放于该处的值</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) x/1s 0x804a20f</span><br><span class="line">0x804a20f:	&quot;%d %d&quot;</span><br></pre></td></tr></table></figure></li>
<li><p>可见，输入的应是空格分隔的两个整数</p>
<ul>
<li>（参考sscanf调用时参数压栈顺序）分别存储于-0x1c(%ebp)(第二个压栈的参数)、-0x20(%ebp)(第一个压栈的参数)</li>
</ul>
</li>
</ul>
<p><img src="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/05/16-47-55-20220605164755-9db933.png"></p>
<ul>
<li><p>变量及其存储地址</p>
<ol>
<li>-0x18(%ebp)：浮点数</li>
<li>-0x1c(%ebp) ：第1个输入整数</li>
<li>-0x20(%ebp) ：第2个输入整数</li>
</ol>
</li>
<li><p><code>0x80494c0-c1</code>处比较了第1个输入整数与浮点数起始存储地址处（小端表示中是其低32位）整数是否相等</p>
</li>
<li><p><code>80494cc-d9</code>处比较了第2个输入整数与浮点数高4个字节存储地址处（小端表示中是其高32位）整数是否相等</p>
</li>
<li><p>因此，输入字符串中应包含分别对应该浮点数表示低32位的整数和高32位的整数</p>
</li>
</ul>
<h2 id="4-基于上述结果，构造输入字符串"><a href="#4-基于上述结果，构造输入字符串" class="headerlink" title="4.基于上述结果，构造输入字符串"></a>4.基于上述结果，构造输入字符串</h2><p>整型值<code>0x97684a1</code>对应的双精度浮点数的IEEE 754表示为（十六进制字节串，从高位到低位）：</p>
<p>41 A2 ED 09 42 00 00 00  </p>
<ul>
<li><p>低32位（从高位到低位）并转为十进制有符号整数：</p>
<p>42 00 00 00 = 1107296256</p>
</li>
<li><p>高32位（从高位到低位）并转为十进制有符号整数：</p>
<p>41 A2 ED 09 = 1101196553</p>
</li>
<li><p>因此拆解字节串应为“1107296256 1101196553”</p>
</li>
</ul>
<p><strong>IDA反汇编的结果是</strong></p>
<p><img src="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/08/22-30-37-20220608223037-cd3847.png"></p>
<h1 id="阶段-2：循环"><a href="#阶段-2：循环" class="headerlink" title="阶段 2：循环"></a>阶段 2：循环</h1><blockquote>
<p>输入满足程序所期望的顺序和取值的一个数字序列</p>
</blockquote>
<p><img src="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/05/23-49-50-20220605234949-b99942.png"></p>
<p>分析结果如上</p>
<p>发现<code>push   $0x9</code>表示数组中有9个数</p>
<p>通过<code>cmp    $0x86,%eax</code>判断出第一个数是134</p>
<p>从<code>0x804951c</code>开始进入循环，<code>0x8049555</code>处进行比较，其中eax是期望的结果，edx是我们输入的结果</p>
<p><strong>通过断点调试</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(gdb) b *0x8049555</span><br><span class="line">(gdb) r</span><br><span class="line">(gdb) i r</span><br><span class="line">eax            0x85                133</span><br><span class="line">ecx            0x86                134</span><br><span class="line">edx            0x85                133</span><br><span class="line">ebx            0x1                 1</span><br></pre></td></tr></table></figure>

<p>可以通过逐步调试得到结果，也可以发现汇编指令的计算方式满足下面形式</p>
<blockquote>
<p>系统生成的eax中的结果满足：Array[i - 1] - 2 * i + 1</p>
</blockquote>
<p>最终结果可以通过<a target="_blank" rel="noopener" href="https://c.runoob.com/compile/10/">这个网站</a>在线编程计算最终结果。</p>
<blockquote>
<p>134 133 130 125 118 109 98 85 70</p>
</blockquote>
<p><strong>IDA反汇编的结果是</strong></p>
<p><img src="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/08/22-29-41-20220608222941-3af148.png"></p>
<h1 id="阶段-3：条件-分支"><a href="#阶段-3：条件-分支" class="headerlink" title="阶段 3：条件/分支"></a>阶段 3：条件/分支</h1><p><img src="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/06/12-27-59-%7DK_%7BW%7BC-7HRI3%606%60KS%609DP9-cf53b5.png"></p>
<p>发现<code>push  $0x804a20f</code>指令，我们可以查看其中的内容</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(gdb) b phase_3</span><br><span class="line">(gdb) r</span><br><span class="line">...</span><br><span class="line">(gdb) si</span><br><span class="line">0x0804959a in phase_3 ()</span><br><span class="line">(gdb) x/1s 0x804a20f</span><br><span class="line">0x804a20f:	&quot;%d %d&quot;</span><br></pre></td></tr></table></figure>

<p>发现是两个参数，所以可以确定输入的是两个数</p>
<p>演示就先输入1 2然后进行调试，当执行到<code>sub  $0xfe,%eax</code>处时，发现<code>eax</code>的值需要做减操作，而<code>0xfe</code>的值是254，<code>eax</code>的值是1，所以sub之后<code>eax</code>值为-253，往下进行，是<code>cmp</code>指令，判断9和<code>eax</code>的大小，<code>ja</code>指令表示无符号大于就跳转，<code>jb</code>表示小于就跳转，所以，如果<code>eax &gt; 9 </code>,就会执行ja跳转到804962d，发生爆炸。<code>jg</code>表示有符号大于</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">80495c0:       sub    $0xfe,%eax   //eax = eax - 0xfe(254) = -253</span><br><span class="line">80495c5:       cmp    $0x9,%eax    //9 &gt; eax 爆炸 ja是大于</span><br><span class="line">80495c8:       ja     804962d &lt;phase_3+0xb4&gt; //爆炸</span><br></pre></td></tr></table></figure>

<p>所以为了继续执行，需要满足<code>eax &lt;= 9</code>,这里先拿9来测试，所以得出在<code>sub</code>之前的<code>eax = 263</code>，<strong>也就是输入的第一个参数的值</strong>，接着继续执行，到达下面这行，也就是说第一个参数满足条件的情况下会<code>eax</code>赋一个地址值，接着执行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">80495ca:    mov    0x804a218(,%eax,4),%eax //eax = 134521368</span><br></pre></td></tr></table></figure>

<p>执行下面的<code>jmp</code>指令之后跳转到<code>0x08049624</code>处，这里对<code>-0xc(%ebp)</code>进行了赋值，<code>3e5 = 997</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">8049624:    movl   $0x3e5,-0xc(%ebp)//ebp = 3e5 = 997</span><br><span class="line">804962b:    jmp    8049639 &lt;phase_3+0xc0&gt;</span><br></pre></td></tr></table></figure>

<p>接着<code>jmp</code>跳转到<code>0x8049639</code>处，这里首先<code>mov</code>指令将我们输入的第二个数赋给了<code>eax</code>，<code>cmp</code>指令对<code>%eax和-0xc(%ebp)</code>的值进行比较，<code>je表示Jump if Equals</code>所以如果这两个值相等就满足条件，所以<code>eax</code>的值就应该是997</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">8049639:    mov    -0x18(%ebp),%eax</span><br><span class="line">804963c:	cmp    %eax,-0xc(%ebp)</span><br><span class="line">804963f:    je     804964d &lt;phase_3+0xd4&gt;</span><br></pre></td></tr></table></figure>

<p><strong>IDA反汇编的结果是</strong></p>
<p><img src="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/08/R5$71RI@[LTY9T]~8Y1_27Q.png"></p>
<h1 id="阶段-4：递归调用和栈"><a href="#阶段-4：递归调用和栈" class="headerlink" title="阶段 4：递归调用和栈"></a>阶段 4：递归调用和栈</h1><p><strong>没有理解！！！</strong></p>
<p>首先定位到下面这行，发现这里有一个地址，可以看看值是什么</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">80496f9:      push   $0x804a20f</span><br></pre></td></tr></table></figure>

<p>发现内容是两个整形的值，这就表示需要输入两个值</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(gdb) b *0x80496f9</span><br><span class="line">(gdb) r res.txt</span><br><span class="line">(gdb) x/1s 0x804a20f</span><br><span class="line">0x804a20f:	&quot;%d %d&quot;</span><br></pre></td></tr></table></figure>

<p>接着往下，输入参数之后就会去调用<code>func4</code>，<code>func4</code>就是一个递归函数，看了半天也没搞命名<code>func4</code>的逻辑，只好用IDA来进行反汇编，可以看到phase_4的反汇编结果</p>
<p><img src="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/08/11-03-18-20220608110317-c08ab5.png"></p>
<p>这里的v5的含义就是我们输入参数的个数，需要判断它是否输入的是两个数，然后是三个递归条件，这里就需要明白v2，v3，v4的含义了，接着看看func4的反汇编结果</p>
<p><img src="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/08/11-05-56-20220608110556-2d71e2.png"></p>
<p>然后再看phase_4的前面的这两行</p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">80496</span>d9:   mov    $0x804a240,%ebx</span><br><span class="line"><span class="number">80496</span>de:   mov    $0x24,%edx <span class="comment">//edx = 0x24(36)</span></span><br></pre></td></tr></table></figure>

<p>这两行的意思是说，先开辟了一段空间，然后放一个数组进去，长度是0x24也就是36.</p>
<p>然后执行到下面这一行发现,<code>ecx</code>的值是从36一直递减到0的</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">80496e9:  rep movsl %ds:(%esi),%es:(%edi)</span><br></pre></td></tr></table></figure>

<p>再往后会发现有两个比较，0和34，同时还有判断是否不等于456</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">8049784:      cmp    $0x1c8,%eax//eax != 456 ?</span><br><span class="line">8049789:      jne    8049797 &lt;phase_4+0xd0&gt;//不等于则跳转</span><br></pre></td></tr></table></figure>

<p>这个先搁置吧，在网上也没找到和我这个一样的， 其他很多都是有比较的指令，感觉比我碰到的这个都要简单些。</p>
<h1 id="阶段-5：指针"><a href="#阶段-5：指针" class="headerlink" title="阶段 5：指针"></a>阶段 5：指针</h1><p><img src="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/09/10-58-16--C6MVT-%7B-%606-BL%60A36IPDUN-444e1c.png"></p>
<p>首先发现push指令处有一个地址</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">80497f3:   push   $0x804a20f</span><br></pre></td></tr></table></figure>

<p>查看这个位置的内容,发现需要输入的是两个数</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) x/1s 0x804a20f</span><br><span class="line">0x804a20f:	&quot;%d %d&quot;</span><br></pre></td></tr></table></figure>

<p>再往下看，发现这是一个循环结构</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">8049831:     addl   $0x1,-0xc(%ebp) //</span><br><span class="line">8049835:     mov    -0x18(%ebp),%eax</span><br><span class="line">8049838:     mov    0x804c200(,%eax,4),%eax //eax = eax*4+0x804c200</span><br><span class="line">804983f:     mov    %eax,-0x18(%ebp)</span><br><span class="line">8049842:     mov    -0x18(%ebp),%eax</span><br><span class="line">8049845:     add    %eax,-0x10(%ebp)</span><br><span class="line">8049848:     mov    -0x18(%ebp),%eax</span><br><span class="line">804984b:     cmp    $0xf,%eax</span><br><span class="line">804984e:     jne    8049831 &lt;phase_5+0x4c&gt;</span><br></pre></td></tr></table></figure>

<p>看了半天没理清楚😶，还是使用IDA进行反编译看看结果吧</p>
<p><img src="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/09/10-34-25-20220609103424-40c87a.png"></p>
<p>这样就清楚了，可以发现，这个循环的条件是<code>v3 != 15</code>,然后后面还有一个数组的赋值操作<code>v3 = array_2751[v3]</code>,这里的数组长度是16，但是我们还是不知道这个数组里面的值是多少，但是可以看出来这个循环中v3的结果是根据数组的值进行变化的，所以我就想到会不会是这种情况，索引0处值为1，索引1处值为2…这种形式，当然，可以输入结果进行测试，因为条件是v3不等于15，而v3就是我们输入的第一个值，v2暂时可以随意输入，所以输入0 1进行测试</p>
<p>到达这个循环里，下面这一句就对应了++v6的操作</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">8049831:  addl   $0x1,-0xc(%ebp) //</span><br></pre></td></tr></table></figure>

<p>然后下面这几句的就是对v3赋值的过程</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">8049835:   mov    -0x18(%ebp),%eax</span><br><span class="line">8049838:   mov    0x804c200(,%eax,4),%eax //eax = eax*4+0x804c200</span><br><span class="line">804983f:   mov    %eax,-0x18(%ebp)</span><br><span class="line">8049842:   mov    -0x18(%ebp),%eax</span><br></pre></td></tr></table></figure>

<p>结束后发现<code>eax</code>的值变成了10，那意思就是说数组中的索引0处的内容就是10，如果要进行下一次循环的话，就该读取索引10处的内容了，然后就是这样一个逻辑，就可以推出后面的值了，当<code>v3==15</code>的时候就会跳出循环</p>
<p>接着会去判断<code>v6==6</code>和<code>v5==v2</code>，从循环处可以发现v6每一次进入循环都会有自增的操作，而v5也是在每一次的循环过程中去进行加操作的，所以拿到v5的值就相当于知道了v2的值了，下面有两个cmp的操作，就是在进行比较</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">8049850:    cmpl   $0x6,-0xc(%ebp) //-0xc(%ebp) == 6 ?</span><br><span class="line">8049854:    jne    804985e &lt;phase_5+0x79&gt;</span><br><span class="line">8049856:    mov    -0x1c(%ebp),%eax</span><br><span class="line">8049859:    cmp    %eax,-0x10(%ebp)</span><br><span class="line">804985c:  	 je     804986a &lt;phase_5+0x85&gt;</span><br><span class="line">804985e:    call   8049ec9 &lt;explode_bomb&gt;</span><br></pre></td></tr></table></figure>

<p>可以在执行完<code>8049859: cmp %eax,-0x10(%ebp)</code>之后查看一下<code>-0x10(%ebp)</code>中的值,这里拿到的<code>0x00000030</code>换算成十进制就是48，所以第二个参数就是48</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) x $ebp-16</span><br><span class="line">0xbffff5a8:	0x00000030</span><br></pre></td></tr></table></figure>

<p>当然，我这种方式是运气好一开始就使用0作为第一个参数来测试的，如果使用的其他值就需要一步一步推出来其他的值，因为其中有一个数组，那就可以输入小于15的值来确定每一个位置的值是多少，我这里得到了数组中所有的值</p>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">索引 0	1  <span class="number"> 2 </span> <span class="number"> 3 </span><span class="number"> 4 </span> <span class="number"> 5 </span> <span class="number"> 6 </span> <span class="number"> 7 </span><span class="number"> 8 </span><span class="number"> 9 </span> <span class="number"> 10 </span><span class="number"> 11 </span> <span class="number"> 12 </span><span class="number"> 13 </span>14    </span><br><span class="line">值	10	<span class="number"> 2 </span><span class="number"> 14 </span> <span class="number"> 7 </span><span class="number"> 8 </span><span class="number"> 12 </span><span class="number"> 15 </span><span class="number"> 11 </span><span class="number"> 0 </span><span class="number"> 4 </span> <span class="number"> 1 </span> <span class="number"> 13 </span> <span class="number"> 3 </span> <span class="number"> 9 </span> 6</span><br></pre></td></tr></table></figure>

<p>然后就可以得到所有的循环结果,但是因为最终跳出循环的结果是v3=15，所以满足条件的就只有第一个也就是0 48</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">0: 10  1   2   14  6   15 sum=48</span><br><span class="line">1: 2   14  6   15  x</span><br><span class="line">2: 14  6   15  x</span><br><span class="line">3: 7   11  13  9   4   8  </span><br><span class="line">4: 8   0   10  1   2   14 </span><br><span class="line">5: 12  3   7   11  13  9  </span><br><span class="line">6: 15 x</span><br><span class="line">7: 11  13  9   4   8   0  </span><br><span class="line">8: 0   10  1   2   14  6  </span><br><span class="line">9: 4   8   0   10  1   2  </span><br><span class="line">10:1   2   14  6   15 x</span><br><span class="line">11:13  9   4   8   0   10 </span><br><span class="line">12:3   7   11  13  9   4  </span><br><span class="line">13:9   4   8   0   10  1  </span><br><span class="line">14:6   15 x</span><br></pre></td></tr></table></figure>



<h1 id="阶段-6：链表-指针-结构"><a href="#阶段-6：链表-指针-结构" class="headerlink" title="阶段 6：链表/指针/结构"></a>阶段 6：链表/指针/结构</h1><p>这个部分有一大堆的代码，很长…</p>
<p><img src="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/09/20-11-21-20220609201120-0245ff.png"></p>
<p>要求应该是输入多个数，因为在里面调用了另外一个函数<code>read_n_numbers</code>，这里会读取输入的数，使用IDA进行反汇编之后就能知道函数的内容了，里面调用了strtok函数，就是对字符串进行分解</p>
<p><img src="https://gcore.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/06/09/16-11-48-20220609161148-a534a5.png"></p>
<p>下面看看第一个循环</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">80498a0:       c7 45 f0 00 00 00 00    movl   $0x0,-0x10(%ebp)</span><br><span class="line">80498a7:       eb 60                   jmp    8049909 &lt;phase_6+0x98&gt;</span><br><span class="line">80498a9:       8b 45 f0                mov    -0x10(%ebp),%eax</span><br><span class="line">80498ac:       8b 44 85 cc             mov    -0x34(%ebp,%eax,4),%eax</span><br><span class="line">80498b0:       85 c0                   test   %eax,%eax</span><br><span class="line">80498b2:       7e 0c                   jle    80498c0 &lt;phase_6+0x4f&gt;</span><br><span class="line">80498b4:       8b 45 f0                mov    -0x10(%ebp),%eax</span><br><span class="line">80498b7:       8b 44 85 cc             mov    -0x34(%ebp,%eax,4),%eax</span><br><span class="line">80498bb:       83 f8 07                cmp    $0x7,%eax</span><br><span class="line">80498be:       7e 0f                   jle    80498cf &lt;phase_6+0x5e&gt;</span><br><span class="line">80498c0:       e8 04 06 00 00          call   8049ec9 &lt;explode_bomb&gt;</span><br><span class="line">80498c5:       b8 00 00 00 00          mov    $0x0,%eax</span><br><span class="line">80498ca:       e9 08 01 00 00          jmp    80499d7 &lt;phase_6+0x166&gt;</span><br><span class="line">80498cf:       8b 45 f0                mov    -0x10(%ebp),%eax</span><br><span class="line">80498d2:       83 c0 01                add    $0x1,%eax</span><br><span class="line">80498d5:       89 45 ec                mov    %eax,-0x14(%ebp)</span><br><span class="line">80498d8:       eb 25                   jmp    80498ff &lt;phase_6+0x8e&gt;</span><br><span class="line">----------------</span><br><span class="line">80498da:       8b 45 f0                mov    -0x10(%ebp),%eax</span><br><span class="line">80498dd:       8b 54 85 cc             mov    -0x34(%ebp,%eax,4),%edx</span><br><span class="line">80498e1:       8b 45 ec                mov    -0x14(%ebp),%eax</span><br><span class="line">80498e4:       8b 44 85 cc             mov    -0x34(%ebp,%eax,4),%eax</span><br><span class="line">80498e8:       39 c2                   cmp    %eax,%edx</span><br><span class="line">80498ea:       75 0f                   jne    80498fb &lt;phase_6+0x8a&gt;</span><br><span class="line">80498ec:       e8 d8 05 00 00          call   8049ec9 &lt;explode_bomb&gt;</span><br><span class="line">80498f1:       b8 00 00 00 00          mov    $0x0,%eax</span><br><span class="line">80498f6:       e9 dc 00 00 00          jmp    80499d7 &lt;phase_6+0x166&gt;</span><br><span class="line">80498fb:       83 45 ec 01             addl   $0x1,-0x14(%ebp)</span><br><span class="line">80498ff:       83 7d ec 06             cmpl   $0x6,-0x14(%ebp)</span><br><span class="line">8049903:       7e d5                   jle    80498da &lt;phase_6+0x69&gt;</span><br><span class="line">------------------</span><br><span class="line">8049905:       83 45 f0 01             addl   $0x1,-0x10(%ebp)</span><br><span class="line">8049909:       83 7d f0 06             cmpl   $0x6,-0x10(%ebp)</span><br><span class="line">804990d:       7e 9a                   jle    80498a9 &lt;phase_6+0x38&gt;</span><br></pre></td></tr></table></figure>

<p>这些就是第一个循环的逻辑，根据逻辑变成c语言代码就是,可以发现其作用是判断输入的数是否大于0小于等于7，同时各个值不相等。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> n_numbers[<span class="number">7</span>] = &#123; <span class="comment">/* 我们输入的7个数 */</span> &#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">6</span>; ++i)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (six_numbers[i] &lt;= <span class="number">0</span> || six_numbers[i] &gt; <span class="number">7</span>)</span><br><span class="line">    explode_bomb();</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> j = i + <span class="number">1</span>; j &lt;= <span class="number">6</span>; ++j)</span><br><span class="line">    <span class="keyword">if</span> (six_numbers[i] == six_numbers[j])</span><br><span class="line">      explode_bomb();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>下面又是循环结构，不过有点复杂，懒得一行一行去分析了，直接到最后一个循环结构，发现前面这段代码</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">8049989:     mov    -0xc(%ebp),%eax</span><br><span class="line">804998c:     movl   $0x0,0x8(%eax) //v7[2]=0x8(%eax)=0 </span><br><span class="line">8049993:     mov    -0x18(%ebp),%eax //v7=%eax=0x804c130</span><br><span class="line">8049996:     mov    %eax,-0xc(%ebp)</span><br></pre></td></tr></table></figure>

<p>这段代码通过IDA编译后发现是下面两句，应该是为了后面的循环中作为判断条件的</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">v7[2] = 0;</span><br><span class="line">v7 = v4;</span><br></pre></td></tr></table></figure>

<p>接着看循环体内部，发现有一个<code>cmp</code>指令,下面的<code>jle</code>的作用是小于或等于，这里比较的内容其实就是上面两句中的参数。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">80499a2:    mov    -0xc(%ebp),%eax</span><br><span class="line">80499a5:    mov    (%eax),%edx</span><br><span class="line">80499a7:    mov    -0xc(%ebp),%eax</span><br><span class="line">80499aa:    mov    0x8(%eax),%eax</span><br><span class="line">80499ad:    mov    (%eax),%eax </span><br><span class="line">80499af:    cmp    %eax,%edx //比较</span><br><span class="line">80499b1:    jle    80499bf &lt;phase_6+0x14e&gt;</span><br><span class="line">80499b3:    call   8049ec9 &lt;explode_bomb&gt;</span><br></pre></td></tr></table></figure>

<p>这里就使用GDB进行调试，查看参数的内容是什么，将断点设置到<code>0x8049993</code>处，查看其中的内容如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) x/4w $eax</span><br><span class="line">0x804c130 &lt;node1&gt;:	0x00000009	0x00000001	0x00000000	0x000003e9</span><br></pre></td></tr></table></figure>

<p>发现有个node1的标识，其实这就是一个链表，同样可以推断出其他node的信息</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">0x804c130 &lt;node1&gt;:	0x00000009	0x00000001	0x0804c124	0x000003e9</span><br><span class="line">0x804c124 &lt;node2&gt;:	0x00000003	0x00000002	0x0804c118	0x00000009</span><br><span class="line">0x804c118 &lt;node3&gt;:	0x00000006	0x00000003	0x0804c10c	0x00000003</span><br><span class="line">0x804c10c &lt;node4&gt;:	0x00000007	0x00000004	0x0804c100	0x00000006</span><br><span class="line">0x804c100 &lt;node5&gt;:	0x00000000	0x00000005	0x0804c0f4	0x00000007</span><br><span class="line">0x804c0f4 &lt;node6&gt;:	0x00000002	0x00000006	0x0804c0e8	0x00000000</span><br><span class="line">0x804c0e8 &lt;node7&gt;:	0x00000005	0x00000007	0x00000000	0x00000002</span><br></pre></td></tr></table></figure>

<p><code>0x804c130</code>结构体中的指针为<code>0x0804c124</code>，这个指针指向node2，同样node2中的指针指向node3 …最后一个node7中的指针指向地址0。</p>
<p><strong>所以这个结构体为：</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="type">int</span> val;<span class="comment">//这个暂不知道是什么数据 </span></span><br><span class="line">    <span class="type">int</span> id;<span class="comment">//id是编号 </span></span><br><span class="line">    node *next;	<span class="comment">//next是指向的node的地址</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>再回到<code>cmp</code>指令，相当于排序的功能了，按照node上数值大小从小到大进行排列，也就是对<code>9(node1) 3(node2) 6(node3) 7(node4) 0(node5) 2(node6) 5(node7)</code>进行排序，结果是<code>node5&lt;node6&lt;node2&lt;node7&lt;node3&lt;node4&lt;node1</code></p>
<p>所以输入的结果就是<code>5 6 2 7 3 4 1</code></p>

    </div>

	
    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:  </strong>小Feng
  </li>
  <li class="post-copyright-link">
    <strong>Post link: </strong>
    <a href="http://zsxfa.cn/2022/06/09/Bomb-Lab/" title="Bomb Lab">http://zsxfa.cn/2022/06/09/Bomb-Lab/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>


	<div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">- - - - - - - - - - - - - 文 章 结 束 <i class="fa fa-whale"></i> 感 谢 阅 读 - - - - - - - - - - - - -</div>
    
</div>

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Bomb%E2%80%94Lab-%E6%B1%87%E7%BC%96/" rel="tag"><i class="fa fa-tag"></i> Bomb—Lab 汇编</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/05/14/kx%E4%B8%8A%E7%BD%91/" rel="prev" title="kx上网">
      <i class="fa fa-chevron-left"></i> kx上网
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    
  <div class="comments">
    <div id="lv-container" data-id="city" data-uid="MTAyMC81NTU4MS8zMjA0OA=="></div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
	
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
	
  </div>

  <aside class="sidebar">
  
    <div class="sidebar-inner">
	
		<meting-js
			server="netease"
			type="playlist"
			autoplay=false 
			fixed=true 
			theme=#0000ff
			id="7267391672"> 
		</meting-js>
	
	  

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%82%B8%E5%BC%B9%E5%AE%9E%E9%AA%8C"><span class="nav-number">1.</span> <span class="nav-text">二进制炸弹实验</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.1.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E6%95%B0%E6%8D%AE"><span class="nav-number">1.2.</span> <span class="nav-text">实验数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E5%B7%A5%E5%85%B7"><span class="nav-number">1.3.</span> <span class="nav-text">实验工具</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#GDB"><span class="nav-number">1.3.1.</span> <span class="nav-text">GDB</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#objdump"><span class="nav-number">1.3.2.</span> <span class="nav-text">objdump</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#strings"><span class="nav-number">1.3.3.</span> <span class="nav-text">strings</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%8D%E6%B1%87%E7%BC%96%E4%BB%A3%E7%A0%81"><span class="nav-number">1.4.</span> <span class="nav-text">反汇编代码</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%8D%E6%B1%87%E7%BC%96%E4%BB%A3%E7%A0%81%E7%9A%84%E7%90%86%E8%A7%A3"><span class="nav-number">1.4.1.</span> <span class="nav-text">反汇编代码的理解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%87%E7%A8%8B%E6%A0%88%E5%B8%A7%E5%8F%8A%E5%85%A5%E5%8F%A3%E5%8F%82%E6%95%B0%E7%9A%84%E4%BD%8D%E7%BD%AE"><span class="nav-number">1.4.2.</span> <span class="nav-text">过程栈帧及入口参数的位置</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%98%B6%E6%AE%B5-0%EF%BC%9A%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%AF%94%E8%BE%83"><span class="nav-number">2.</span> <span class="nav-text">阶段 0：字符串比较</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E5%AF%B9%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%82%B8%E5%BC%B9%E7%A8%8B%E5%BA%8F%E8%BF%9B%E8%A1%8C%E5%8F%8D%E6%B1%87%E7%BC%96"><span class="nav-number">2.1.</span> <span class="nav-text">1.对二进制炸弹程序进行反汇编</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E5%AF%B9%E5%87%BD%E6%95%B0%E7%9A%84%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4%E4%BB%A3%E7%A0%81%E8%BF%9B%E8%A1%8C%E5%88%86%E6%9E%90"><span class="nav-number">2.2.</span> <span class="nav-text">2.对函数的汇编指令代码进行分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E5%AE%9A%E4%BD%8D%E5%B9%B6%E8%8E%B7%E5%BE%97%E5%86%85%E7%BD%AE%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E5%80%BC%EF%BC%8C%E5%B9%B6%E7%9B%B8%E5%BA%94%E6%9E%84%E9%80%A0%E8%BE%93%E5%85%A5%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">2.3.</span> <span class="nav-text">3.定位并获得内置字符串的值，并相应构造输入字符串</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E6%B5%8B%E8%AF%95"><span class="nav-number">2.3.1.</span> <span class="nav-text">4.测试</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%98%B6%E6%AE%B5-1%EF%BC%9A%E6%B5%AE%E7%82%B9%E6%95%B0%E8%A1%A8%E7%A4%BA"><span class="nav-number">3.</span> <span class="nav-text">阶段 1：浮点数表示</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#IEEE-754%E6%A0%87%E5%87%86"><span class="nav-number">3.1.</span> <span class="nav-text">IEEE 754标准</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#X87%E6%B5%AE%E7%82%B9%E6%8C%87%E4%BB%A4-MMX%E5%92%8CSSE%E6%8C%87%E4%BB%A4"><span class="nav-number">3.2.</span> <span class="nav-text">X87浮点指令(MMX和SSE指令)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#X87-FPU%E6%8C%87%E4%BB%A4"><span class="nav-number">3.3.</span> <span class="nav-text">X87 FPU指令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E5%AF%B9%E6%9C%AC%E9%98%B6%E6%AE%B5%E5%87%BD%E6%95%B0%E7%9A%84%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4%E4%BB%A3%E7%A0%81%E8%BF%9B%E8%A1%8C%E5%88%86%E6%9E%90"><span class="nav-number">3.4.</span> <span class="nav-text">1.对本阶段函数的汇编指令代码进行分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E6%89%BE%E5%88%B0%E6%B5%AE%E7%82%B9%E6%95%B0%E5%B8%B8%E9%87%8F%E7%9A%84%E5%80%BC%EF%BC%8C%E8%8E%B7%E5%BE%97%E5%85%B6IEEE-754%E8%A1%A8%E7%A4%BA"><span class="nav-number">3.5.</span> <span class="nav-text">2.找到浮点数常量的值，获得其IEEE-754表示</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E5%88%86%E6%9E%90%E7%A8%8B%E5%BA%8F%E7%9A%84%E8%BE%93%E5%85%A5%E8%A6%81%E6%B1%82%E5%92%8C%E6%AF%94%E8%BE%83%E9%80%BB%E8%BE%91"><span class="nav-number">3.6.</span> <span class="nav-text">3.分析程序的输入要求和比较逻辑</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E5%9F%BA%E4%BA%8E%E4%B8%8A%E8%BF%B0%E7%BB%93%E6%9E%9C%EF%BC%8C%E6%9E%84%E9%80%A0%E8%BE%93%E5%85%A5%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">3.7.</span> <span class="nav-text">4.基于上述结果，构造输入字符串</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%98%B6%E6%AE%B5-2%EF%BC%9A%E5%BE%AA%E7%8E%AF"><span class="nav-number">4.</span> <span class="nav-text">阶段 2：循环</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%98%B6%E6%AE%B5-3%EF%BC%9A%E6%9D%A1%E4%BB%B6-%E5%88%86%E6%94%AF"><span class="nav-number">5.</span> <span class="nav-text">阶段 3：条件&#x2F;分支</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%98%B6%E6%AE%B5-4%EF%BC%9A%E9%80%92%E5%BD%92%E8%B0%83%E7%94%A8%E5%92%8C%E6%A0%88"><span class="nav-number">6.</span> <span class="nav-text">阶段 4：递归调用和栈</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%98%B6%E6%AE%B5-5%EF%BC%9A%E6%8C%87%E9%92%88"><span class="nav-number">7.</span> <span class="nav-text">阶段 5：指针</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%98%B6%E6%AE%B5-6%EF%BC%9A%E9%93%BE%E8%A1%A8-%E6%8C%87%E9%92%88-%E7%BB%93%E6%9E%84"><span class="nav-number">8.</span> <span class="nav-text">阶段 6：链表&#x2F;指针&#x2F;结构</span></a></li></ol></div>
      </div>
      <!--/noindex-->
	  
	  

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="小Feng"
      src="https://cdn.jsdelivr.net/gh/zsxfa/CDN/img/md/2022/01/14/1642171382.png">
  <p class="site-author-name" itemprop="name">小Feng</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">24</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/zsxfa" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;zsxfa" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:zsxfa125689@163.com" title="E-Mail → mailto:zsxfa125689@163.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://blog.csdn.net/m0_46132054" title="CSDN → https:&#x2F;&#x2F;blog.csdn.net&#x2F;m0_46132054" rel="noopener" target="_blank"><i class="fa fa-copyright fa-fw"></i>CSDN</a>
      </span>
  </div>
  <div class="">
    <a target="_blank" class="social-link" href="/atom.xml" style="color: burlywood;">
      <span class="icon">
        <i class="fa fa-rss"></i>
      </span>
      <span class="label">RSS</span>
    </a>
  </div>



      </div>
	  
	  <div id="binft"></div>
  <script>
    var binft = function (r) {
      function t() {
        return b[Math.floor(Math.random() * b.length)]
      }  
      function e() {
        return String.fromCharCode(94 * Math.random() + 33)
      }
      function n(r) {
        for (var n = document.createDocumentFragment(), i = 0; r > i; i++) {
          var l = document.createElement("span");
          l.textContent = e(), l.style.color = t(), n.appendChild(l)
        }
        return n
      }
      function i() {
        var t = o[c.skillI];
        c.step ? c.step-- : (c.step = g, c.prefixP < l.length ? (c.prefixP >= 0 && (c.text += l[c.prefixP]), c.prefixP++) : "forward" === c.direction ? c.skillP < t.length ? (c.text += t[c.skillP], c.skillP++) : c.delay ? c.delay-- : (c.direction = "backward", c.delay = a) : c.skillP > 0 ? (c.text = c.text.slice(0, -1), c.skillP--) : (c.skillI = (c.skillI + 1) % o.length, c.direction = "forward")), r.textContent = c.text, r.appendChild(n(c.prefixP < l.length ? Math.min(s, s + c.prefixP) : Math.min(s, t.length - c.skillP))), setTimeout(i, d)
      }

      var l = "",
      o = [" 人生如逆旅，我亦是行人"].map(function (r) {
      return r + ""
      }),
      a = 2,
      g = 1,
      s = 5,
      d = 75,
      b = ["rgb(110,64,170)", "rgb(150,61,179)", "rgb(191,60,175)", "rgb(228,65,157)", "rgb(254,75,131)", "rgb(255,94,99)", "rgb(255,120,71)", "rgb(251,150,51)", "rgb(226,183,47)", "rgb(198,214,60)", "rgb(175,240,91)", "rgb(127,246,88)", "rgb(82,246,103)", "rgb(48,239,130)", "rgb(29,223,163)", "rgb(26,199,194)", "rgb(35,171,216)", "rgb(54,140,225)", "rgb(76,110,219)", "rgb(96,84,200)"],
      c = {
        text: "",
        prefixP: -s,
        skillI: 0,
        skillP: 0,
        direction: "forward",
        delay: a,
        step: g
      };
      i()
      };
      binft(document.getElementById('binft'));
  </script>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
	  

    </div>
	
	
  </aside>
  
  
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">小Feng</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">Symbols count total: </span>
    <span title="Symbols count total">620k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">Reading time total &asymp;</span>
    <span title="Reading time total">9:24</span>
</div>

<!--添加运行时间-->
<span id="sitetime"></span>
<script language=javascript>
	function siteTime(){
		window.setTimeout("siteTime()", 1000);
		var seconds = 1000;
		var minutes = seconds * 60;
		var hours = minutes * 60;
		var days = hours * 24;
		var years = days * 365;
		var today = new Date();
		var todayYear = today.getFullYear();
		var todayMonth = today.getMonth()+1;
		var todayDate = today.getDate();
		var todayHour = today.getHours();
		var todayMinute = today.getMinutes();
		var todaySecond = today.getSeconds();
		/* 
      Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
      year - 作为date对象的年份，为4位年份值
      month - 0-11之间的整数，做为date对象的月份
      day - 1-31之间的整数，做为date对象的天数
      hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
      minutes - 0-59之间的整数，做为date对象的分钟数
      seconds - 0-59之间的整数，做为date对象的秒数
      microseconds - 0-999之间的整数，做为date对象的毫秒数
     */
		var t1 = Date.UTC(2022,01,10,20,00,00); //北京时间2018-2-13 00:00:00
		var t2 = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond);
		var diff = t2-t1;
		var diffYears = Math.floor(diff/years);
		var diffDays = Math.floor((diff/days)-diffYears*365);
		var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours);
		var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes);
		var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);
		document.getElementById("sitetime").innerHTML=" 本站已运行"+/*diffYears+" 年 "+*/diffDays+" 天 "+diffHours+" 小时 "+diffMinutes+" 分钟 "+diffSeconds+" 秒";
	}
	siteTime();
</script>
<!--// 添加运行时间-->

<!-- 新增访客统计代码 -->
<div class="busuanzi-count">
	<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span id="busuanzi_container_site_pv">
		本站总访问量<span id="busuanzi_value_site_pv"></span>次
	</span>
	<span class="post-meta-divider">|</span>
	<span id="busuanzi_container_site_uv">
		本站访客数<span id="busuanzi_value_site_uv"></span>人次
	</span>
</div>
<!-- 新增访客统计代码 END-->


        








      </div>
    </footer>
  </div>

  
  <script size="300" alpha="0.6" zIndex="-1" src="/lib/canvas-ribbon/canvas-ribbon.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/pjax/pjax.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>

<script src="/js/utils.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  




  
<script src="/js/local-search.js"></script>













    <div id="pjax">
  

  

<script>
NexT.utils.loadComments(document.querySelector('#lv-container'), () => {
  window.livereOptions = {
    refer: location.pathname.replace(CONFIG.root, '').replace('index.html', '')
  };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
});
</script>

    </div>
  

<script type="text/javascript"
color="0,0,255" opacity='0.7' zIndex="-1" count="99" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>



<!-- 页面点击小红心 
<script type="text/javascript" src="/js/heart.js"></script> -->
<!-- 页面点击烟花爆炸 -->
<canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas> 
<script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> 
<script type="text/javascript" src="/js/firework.js"></script>

<!-- 音乐播放 -->
<!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css"><!--APlayer的样式-->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zsxfa/CDN/APlayer.min.css">
<script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><!--APlayer的依赖-->
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><!--Meting的依赖-->

<!-- 样式一（鼠标点击更换样式） -->
<script src="https://g.joyinshare.com/hc/ribbon.min.js" type="text/javascript"></script>
<!-- 样式二（飘动的彩带） -->
<script src="https://g.joyinshare.com/hc/piao.js" type="text/javascript"></script>

</body>
<!-- 页面恶搞-->
<script type="text/javascript" src="\js\funny.js"></script> 
</html>
